{"version":3,"sources":["components/HousePackage/index.js","components/HousePackage/index.module.css","utils/axios.js","utils/index.js","pages/Rent/Add/index.module.css","pages/Rent/Add/index.js","utils/api/City/index.js","utils/api/House/index.js"],"names":["HOUSE_PACKAGE","id","name","icon","HousePackage","state","selectedNames","toggleSelect","newSelectedNames","indexOf","filter","item","props","onSelect","setState","this","select","list","v","includes","map","isSelected","key","className","styles","active","join","onClick","root","renderItems","Component","module","exports","BASE_URL","api","axios","create","baseURL","interceptors","request","use","config","loading","url","headers","startsWith","authorization","getToken","error","Promise","reject","response","hide","body","data","description","status","CURR_CITY","HKZF_TOKEN","setLocal","val","window","localStorage","setItem","getLocal","getItem","removeToken","console","log","removeItem","isAuth","getCityName","a","resolve","BMap","LocalCity","get","res","getCurrcity","curCity","JSON","parse","reslName","substr","label","getCityInfo","stringify","alert","roomTypeData","value","orientedData","floorData","RentAdd","onCancel","text","onPress","history","go","getValue","addHouse","community","price","size","roomType","floor","oriented","supporting","tempSlides","title","info","fd","FormData","forEach","append","file","postImage","serverImg","fail","otd","houseImg","pubHouse","success","replace","push","backUrl","location","pathname","handleImage","files","operationType","index","Item","navHeader","mode","type","onLeftClick","header","renderHeader","data-role","extra","arrow","placeholder","onChange","cols","pics","multiple","imgpicker","selectNames","desc","rows","autoHeight","bottom","cancel","confirm","params","getCityList","level","getCityData","getFilter","getHouses","cityId","filters","start","end","getHousesId","getCommunity","post","getMapHouse"],"mappings":"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","file":"static/js/14.925e4979.chunk.js","sourcesContent":["import React, { Component } from 'react'\n\nimport styles from './index.module.css'\n\n// 所有房屋配套数据和图标\nconst HOUSE_PACKAGE = [\n  {\n    id: 1,\n    name: '衣柜',\n    icon: 'icon-wardrobe'\n  },\n  {\n    id: 2,\n    name: '洗衣机',\n    icon: 'icon-wash'\n  },\n  {\n    id: 3,\n    name: '空调',\n    icon: 'icon-air'\n  },\n  {\n    id: 4,\n    name: '天然气',\n    icon: 'icon-gas'\n  },\n  {\n    id: 5,\n    name: '冰箱',\n    icon: 'icon-ref'\n  },\n  {\n    id: 6,\n    name: '暖气',\n    icon: 'icon-Heat'\n  },\n  {\n    id: 7,\n    name: '电视',\n    icon: 'icon-vid'\n  },\n  {\n    id: 8,\n    name: '热水器',\n    icon: 'icon-heater'\n  },\n  {\n    id: 9,\n    name: '宽带',\n    icon: 'icon-broadband'\n  },\n  {\n    id: 10,\n    name: '沙发',\n    icon: 'icon-sofa'\n  }\n]\n\n/* \n  该组件的两种功能：\n  1 根据传入的 list 展示房屋配置列表（房源详情页面）\n    <HousePackage list={['衣柜', '洗衣机']} />\n  2 从所有配置列表中选择房屋配置（发布房源页面）\n    <HousePackage select onSelect={selectedItems => {...}} />\n*/\nexport default class HousePackage extends Component {\n  state = {\n    // 选中名称\n    selectedNames: []\n  }\n\n  // 根据id切换选中状态\n  toggleSelect = name => {\n    const { selectedNames } = this.state\n    let newSelectedNames\n\n    // 判断该项是否选中\n    if (selectedNames.indexOf(name) > -1) {\n      // 选中：从数组中删除选中项，也就是保留未选中项\n      newSelectedNames = selectedNames.filter(item => item !== name)\n    } else {\n      // 未选中：添加到数组中\n      newSelectedNames = [...selectedNames, name]\n    }\n\n    // 传递给父组件\n    this.props.onSelect(newSelectedNames)\n\n    this.setState({\n      selectedNames: newSelectedNames\n    })\n  }\n\n  // 渲染列表项\n  renderItems() {\n    const { selectedNames } = this.state\n    // select 的值为 true 表示 选择房屋配置；false 表示仅展示房屋列表\n    // list 表示要展示的列表项\n    const { select, list } = this.props\n\n    let data\n    // 如果传了 select 表示：选择 房屋配置\n    // 如果没传 select 表示：展示 房屋配置 列表\n    if (select) {\n      data = HOUSE_PACKAGE\n    } else {\n      // 展示房屋配置列表\n      // 从所有的列表项中过滤出要展示的（list）列表项\n      data = HOUSE_PACKAGE.filter(v => list.includes(v.name))\n    }\n\n    return data.map(item => {\n      // 判断该项是否选中\n      const isSelected = selectedNames.indexOf(item.name) > -1\n\n      return (\n        <li\n          key={item.id}\n          className={[styles.item, isSelected ? styles.active : ''].join(' ')}\n          onClick={select && (() => this.toggleSelect(item.name))}\n        >\n          <p>\n            <i className={`iconfont ${item.icon} ${styles.icon}`} />\n          </p>\n          {item.name}\n        </li>\n      )\n    })\n  }\n\n  render() {\n    return <ul className={styles.root}>{this.renderItems()}</ul>\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"HousePackage_root__1MUw0\",\"item\":\"HousePackage_item__2q4AQ\",\"active\":\"HousePackage_active__dDdti\",\"icon\":\"HousePackage_icon__2hT31\"};","import axios from \"axios\"\n// loading组件\nimport { Toast } from \"antd-mobile\"\nimport { getToken } from \"./index.js\"\n\n// baseurl\nconst BASE_URL = \"https://api-haoke-web.itheima.net\"\n\n//封装axios\nconst api = axios.create({\n  baseURL: BASE_URL,\n})\n\n//请求拦截器\napi.interceptors.request.use(\n  function (config) {\n    Toast.loading(\"Loading...\", 0)\n    const switchUser = [\"/user/registered\", \"/user/login\"]\n    const { url, headers } = config\n\n    if (url.startsWith(\"/user\") && !switchUser.includes(url)) {\n      headers.authorization = getToken()\n    }\n\n    // Do something before request is sent\n    return config\n  },\n  function (error) {\n    // Do something with request error\n    return Promise.reject(error)\n  }\n)\n\n// 响应拦截器\n// Add a response interceptor\napi.interceptors.response.use(\n  function (response) {\n    Toast.hide()\n    // console.log(response)\n\n    const res = {\n      body: response.data.body,\n      description: response.data.description,\n      status: response.data.status,\n    }\n    // Any status code that lie within the range of 2xx cause this function to trigger\n    // Do something with response data\n    return res\n  },\n  function (error) {\n    // Any status codes that falls outside the range of 2xx cause this function to trigger\n    // Do something with response error\n    return Promise.reject(error)\n  }\n)\n\nexport default api\nexport { BASE_URL }\n","import { getCityInfo } from \"./api/City/index.js\"\n\nconst CURR_CITY = \"curr_city\",\n  HKZF_TOKEN = \"HKZF_TOKEN\"\n// 封装本地存储方法\n// 添加本地存储\nexport function setLocal(key, val) {\n  return window.localStorage.setItem(key, val)\n}\n// 获取本地存储\nexport function getLocal(key) {\n  return localStorage.getItem(key)\n}\n\n// 删除本地存储\nexport function deLocal(key) {\n  return localStorage.removeItem(key)\n}\n\n// 封装持久化token\nexport function setToken(token) {\n  setLocal(HKZF_TOKEN, token)\n}\n\nexport function getToken() {\n  return getLocal(HKZF_TOKEN)\n}\n\nexport function removeToken() {\n  console.log(\"1\")\n\n  deLocal(HKZF_TOKEN)\n}\n\n// 判断鉴权\nconst isAuth = () => !!getToken()\n\nconst getCityName = async () => {\n  return new Promise((resolve, reject) => {\n    // 根据ip获取城市定位信息\n    let myCity = new window.BMap.LocalCity()\n    // 调用获取定位城市实例\n    myCity.get((res) => {\n      // 调用接口获取城市详细信息\n      resolve(res.name)\n    })\n  })\n}\n\nexport async function getCurrcity() {\n  // 从本地获取之前保存过的城市定位信息\n  const curCity = JSON.parse(getLocal(CURR_CITY))\n  // console.log(curCity)\n\n  let res = await getCityName()\n  let reslName = res.substr(0, 2)\n\n  // console.log(reslName)\n\n  if (!curCity || reslName !== curCity.label) {\n    // 如果没有\n    // 获取定位信息，返回promise对象，resolve结果\n    return new Promise(async (resolve, reject) => {\n      // 调用接口获取城市详细信息\n      const { status, body } = await getCityInfo(reslName)\n      if (status === 200) {\n        // 存储到本地\n        setLocal(CURR_CITY, JSON.stringify(body))\n        // console.log(body)\n\n        // 传递数据\n        resolve(body)\n      } else {\n        reject(\"error\")\n      }\n    })\n  } else {\n    // 如果有，返回信息\n    return Promise.resolve(curCity)\n  }\n}\n\nexport { CURR_CITY, HKZF_TOKEN, isAuth }\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Add_root__2_C-z\",\"bottom\":\"Add_bottom__Pir6G\",\"cancel\":\"Add_cancel__1f986\",\"imgpicker\":\"Add_imgpicker__2WCKl\",\"input\":\"Add_input__KvW_g\",\"label\":\"Add_label__1-z0u\",\"confirm\":\"Add_confirm__34c_r\",\"title\":\"Add_title__eWgIh\",\"pics\":\"Add_pics__2r1Id\",\"supporting\":\"Add_supporting__3H7fo\",\"desc\":\"Add_desc__1Gqte\"};","import React, { Component } from \"react\"\n\nimport {\n  Flex,\n  List,\n  InputItem,\n  Picker,\n  ImagePicker,\n  TextareaItem,\n  Modal,\n  NavBar,\n  Icon,\n  Toast,\n} from \"antd-mobile\"\n\nimport HousePackage from \"../../../components/HousePackage\"\n\nimport styles from \"./index.module.css\"\nimport { postImage, pubHouse } from \"../../../utils/api/House\"\n\nconst alert = Modal.alert\n\n// 房屋类型\nconst roomTypeData = [\n  { label: \"一室\", value: \"ROOM|d4a692e4-a177-37fd\" },\n  { label: \"二室\", value: \"ROOM|d1a00384-5801-d5cd\" },\n  { label: \"三室\", value: \"ROOM|20903ae0-c7bc-f2e2\" },\n  { label: \"四室\", value: \"ROOM|ce2a5daa-811d-2f49\" },\n  { label: \"四室+\", value: \"ROOM|2731c38c-5b19-ff7f\" },\n]\n\n// 朝向：\nconst orientedData = [\n  { label: \"东\", value: \"ORIEN|141b98bf-1ad0-11e3\" },\n  { label: \"西\", value: \"ORIEN|103fb3aa-e8b4-de0e\" },\n  { label: \"南\", value: \"ORIEN|61e99445-e95e-7f37\" },\n  { label: \"北\", value: \"ORIEN|caa6f80b-b764-c2df\" },\n  { label: \"东南\", value: \"ORIEN|dfb1b36b-e0d1-0977\" },\n  { label: \"东北\", value: \"ORIEN|67ac2205-7e0f-c057\" },\n  { label: \"西南\", value: \"ORIEN|2354e89e-3918-9cef\" },\n  { label: \"西北\", value: \"ORIEN|80795f1a-e32f-feb9\" },\n]\n\n// 楼层\nconst floorData = [\n  { label: \"高楼层\", value: \"FLOOR|1\" },\n  { label: \"中楼层\", value: \"FLOOR|2\" },\n  { label: \"低楼层\", value: \"FLOOR|3\" },\n]\n\nexport default class RentAdd extends Component {\n  constructor(props) {\n    super(props)\n    const { data = {} } = this.props.location\n\n    this.state = {\n      // 临时图片地址\n      tempSlides: [],\n\n      // 小区的名称和id\n      community: {\n        name: data.name,\n        id: data.id,\n      },\n      // 价格\n      price: \"\",\n      // 面积\n      size: \"\",\n      // 房屋类型\n      roomType: \"\",\n      // 楼层\n      floor: \"\",\n      // 朝向：\n      oriented: \"\",\n      // 房屋标题\n      title: \"\",\n      // 房屋图片\n      houseImg: \"\",\n      // 房屋配套：\n      supporting: \"\",\n      // 房屋描述\n      description: \"\",\n    }\n  }\n\n  // 取消编辑，返回上一页\n  onCancel = () => {\n    alert(\"提示\", \"放弃发布房源?\", [\n      {\n        text: \"放弃\",\n        onPress: async () => this.props.history.go(-1),\n      },\n      {\n        text: \"继续编辑\",\n      },\n    ])\n  }\n\n  getValue = (val, name) => {\n    this.setState({\n      [name]: val,\n    })\n  }\n  // 点击发布\n  addHouse = async () => {\n    const {\n      community,\n      price,\n      size,\n      roomType,\n      floor,\n      oriented,\n      description,\n      supporting,\n      tempSlides,\n      title,\n    } = this.state\n    if (!price || !size || !title) {\n      return Toast.info(\"请输入房源基本信息！\", 1)\n    }\n\n    // const { tempSlides } = this.state\n    let serverImg\n    // if (tempSlides.length) {\n    let fd = new FormData()\n\n    tempSlides.forEach((item) => fd.append(\"file\", item.file))\n    const res = await postImage(fd)\n    console.log(res)\n\n    if (res.status === 200) {\n      serverImg = res.body.join(\"|\")\n    } else {\n      Toast.fail(res.description, 2)\n    }\n\n    const otd = {\n      community: community.id,\n      price,\n      size,\n      roomType,\n      floor,\n      oriented,\n      description,\n      supporting,\n      houseImg: serverImg,\n      title,\n    }\n    const { status } = await pubHouse(otd)\n    if (status === 200) {\n      Toast.success(\"发布信息成功\", 1, () => {\n        this.props.history.replace(\"/rent\")\n      })\n    } else {\n      if (status === 400) {\n        Toast.info(\"请重新登录！\", 1, () => {\n          this.props.history.push(\"/login\", {\n            backUrl: this.props.location.pathname,\n          })\n        })\n      }\n    }\n\n    // }\n  }\n\n  // 添加要上传的图片\n  handleImage = (files, operationType, index) => {\n    // console.log(files, operationType, index)\n    this.setState({\n      tempSlides: files,\n    })\n  }\n\n  render() {\n    const Item = List.Item\n    const { history } = this.props\n    const {\n      community,\n      price,\n      size,\n      roomType,\n      floor,\n      oriented,\n      description,\n      tempSlides,\n      title,\n    } = this.state\n\n    return (\n      <div className={styles.root}>\n        <NavBar\n          className={styles.navHeader}\n          mode=\"dark\"\n          icon={<Icon type=\"left\" />}\n          onLeftClick={this.onCancel}\n        >\n          发布房源\n        </NavBar>\n        <List\n          className={styles.header}\n          renderHeader={() => \"基本信息\"}\n          data-role=\"rent-list\"\n        >\n          {/* 选择所在小区 */}\n          <Item\n            extra={community.name || \"请选择小区名称\"}\n            arrow=\"horizontal\"\n            onClick={() => history.replace(\"/rent/search\")}\n          >\n            小区名称\n          </Item>\n          <InputItem\n            placeholder=\"请输入租金/月\"\n            extra=\"￥/月\"\n            type=\"number\"\n            value={price}\n            onChange={(v) => this.getValue(v, \"price\")}\n          >\n            租&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;金\n          </InputItem>\n          <InputItem\n            placeholder=\"请输入建筑面积\"\n            extra=\"㎡\"\n            type=\"number\"\n            value={size}\n            onChange={(v) => this.getValue(v, \"size\")}\n          >\n            建筑面积\n          </InputItem>\n          <Picker\n            data={roomTypeData}\n            onChange={(v) => this.getValue(v[0], \"roomType\")}\n            value={[roomType]}\n            cols={1}\n          >\n            <Item arrow=\"horizontal\">\n              户&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;型\n            </Item>\n          </Picker>\n\n          <Picker\n            data={floorData}\n            value={[floor]}\n            cols={1}\n            onChange={(v) => this.getValue(v[0], \"floor\")}\n          >\n            <Item arrow=\"horizontal\">所在楼层</Item>\n          </Picker>\n          <Picker\n            data={orientedData}\n            value={[oriented]}\n            cols={1}\n            onChange={(v) => this.getValue(v[0], \"oriented\")}\n          >\n            <Item arrow=\"horizontal\">\n              朝&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;向\n            </Item>\n          </Picker>\n        </List>\n\n        <List\n          className={styles.title}\n          renderHeader={() => \"房屋标题\"}\n          data-role=\"rent-list\"\n        >\n          <InputItem\n            placeholder=\"请输入标题（例如：整租 小区名 2室 5000元）\"\n            value={title}\n            onChange={(v) => this.getValue(v, \"title\")}\n          />\n        </List>\n\n        <List\n          className={styles.pics}\n          renderHeader={() => \"房屋图像\"}\n          data-role=\"rent-list\"\n        >\n          <ImagePicker\n            files={tempSlides}\n            multiple={true}\n            className={styles.imgpicker}\n            onChange={this.handleImage}\n          />\n        </List>\n\n        <List\n          className={styles.supporting}\n          renderHeader={() => \"房屋配置\"}\n          data-role=\"rent-list\"\n        >\n          <HousePackage\n            select\n            onSelect={(selectNames) => {\n              this.setState({\n                supporting: selectNames.join(\"|\"),\n              })\n            }}\n          />\n        </List>\n\n        <List\n          className={styles.desc}\n          renderHeader={() => \"房屋描述\"}\n          data-role=\"rent-list\"\n        >\n          <TextareaItem\n            rows={5}\n            placeholder=\"请输入房屋描述信息\"\n            autoHeight\n            value={description}\n            onChange={(v) => this.getValue(v, \"description\")}\n          />\n        </List>\n\n        <Flex className={styles.bottom}>\n          <Flex.Item className={styles.cancel} onClick={this.onCancel}>\n            取消\n          </Flex.Item>\n          <Flex.Item className={styles.confirm} onClick={this.addHouse}>\n            提交\n          </Flex.Item>\n        </Flex>\n      </div>\n    )\n  }\n}\n","import api from \"../../axios.js\"\n\n// 城市列表\nexport function getCityInfo(name) {\n  return api.get(\"/area/info\", {\n    params: {\n      name,\n    },\n  })\n}\n\n// 获取城市列表数据\nexport function getCityList(level = 1) {\n  return api.get(\"/area/city\", {\n    params: {\n      level,\n    },\n  })\n}\n\n//获取热门城市\nexport function getCityData() {\n  return api.get(\"/area/hot\")\n}\n","import api from \"../../axios.js\"\n\n// 获取房屋查询条件\n\nexport function getFilter(id) {\n  return api.get(\"/houses/condition\", {\n    params: {\n      id,\n    },\n  })\n}\n\n// 根据条件查询房屋\nexport function getHouses(cityId, filters, start, end) {\n  return api.get(\"/houses\", {\n    params: {\n      cityId,\n      ...filters,\n      start,\n      end,\n    },\n  })\n}\n\n// 根据房屋获取具体信息\nexport function getHousesId(id) {\n  return api.get(`/houses/${id}`)\n}\n\n// 小区关键词查询\nexport function getCommunity(id, name) {\n  return api.get(\"/area/community\", {\n    params: {\n      id,\n      name,\n    },\n  })\n}\n\n// 房屋图像上传\nexport function postImage(data) {\n  return api.post(`/houses/image`, data)\n}\n\n// 发布房源\nexport function pubHouse(body) {\n  return api.post(\"/user/houses\", body)\n}\n\n// 查询房源数据\nexport function getMapHouse(id) {\n  return api.get(\"/area/map\", {\n    params: {\n      id,\n    },\n  })\n}\n"],"sourceRoot":""}